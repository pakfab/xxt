<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f6; margin: 0; padding: 20px; }
    .container { max-width: 700px; margin: auto; background: white; padding: 25px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    h1 { text-align: center; color: #333; }
    fieldset { border: 1px solid #ccc; border-radius: 5px; padding: 15px; margin-bottom: 20px; }
    legend { font-weight: bold; font-size: 1.2em; color: #0056b3; padding: 0 10px; }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; color: #555; font-weight: bold; }
    select, input[type="number"] { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
    select:disabled { background-color: #e9ecef; }
    button { width: 100%; padding: 12px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; font-weight: bold; }
    button:disabled { background-color: #aaa; }
    button:hover:not(:disabled) { background-color: #0056b3; }
    #status { margin-top: 15px; text-align: center; font-weight: bold; padding: 10px; border-radius: 4px; display: none; }
    .success { background-color: #d4edda; color: #155724; }
    .error { background-color: #f8d7da; color: #721c24; }
  </style>
</head>
<body>

  <div class="container">
    <h1>Penilaian Pak Fab</h1>
    <form id="penilaianForm">
      
      <fieldset>
        <legend>Data Murid</legend>
        <div class="form-group">
          <label for="kelas">Kelas</label>
          <select id="kelas" name="kelas" required>
            <option value="">Memuat kelas...</option>
          </select>
        </div>
        <div class="form-group">
          <label for="nama_murid">Nama Murid</label>
          <select id="nama_murid" name="nama_murid" required disabled>
            <option value="">Pilih kelas terlebih dahulu</option>
          </select>
        </div>
      </fieldset>

      <fieldset>
        <legend>1. Akord</legend>
        <div class="form-group">
          <label>Kebenaran Posisi Jari (Maks: 15)</label>
          <input type="number" name="akord_posisi_jari" min="0" max="15" required>
        </div>
        <div class="form-group">
            <label>Kebersihan Suara (Maks: 15)</label>
            <input type="number" name="akord_kebersihan_suara" min="0" max="15" required>
        </div>
        <div class="form-group">
            <label>Kelancaran Perpindahan (Maks: 10)</label>
            <input type="number" name="akord_kelancaran" min="0" max="10" required>
        </div>
      </fieldset>
      <fieldset>
        <legend>2. Pola Strumming 1</legend>
        <div class="form-group">
            <label>Arah Gerakan Tangan (Maks: 10)</label>
            <input type="number" name="strum1_arah" min="0" max="10" required>
        </div>
        <div class="form-group">
            <label>Konsistensi Ritme (Maks: 10)</label>
            <input type="number" name="strum1_ritme" min="0" max="10" required>
        </div>
        <div class="form-group">
            <label>Kebersihan Suara (Maks: 10)</label>
            <input type="number" name="strum1_suara" min="0" max="10" required>
        </div>
      </fieldset>
      <fieldset>
        <legend>3. Pola Strumming 2</legend>
        <div class="form-group">
            <label>Arah Gerakan Tangan (Maks: 10)</label>
            <input type="number" name="strum2_arah" min="0" max="10" required>
        </div>
        <div class="form-group">
            <label>Konsistensi Ritme (Maks: 10)</label>
            <input type="number" name="strum2_ritme" min="0" max="10" required>
        </div>
        <div class="form-group">
            <label>Kebersihan Suara (Maks: 10)</label>
            <input type="number" name="strum2_suara" min="0" max="10" required>
        </div>
      </fieldset>
      
      <button type="submit" id="submitButton">Kirim Penilaian</button>
      <div id="status"></div>
    </form>
  </div>

  <script>
    // GANTI DENGAN URL APLIKASI WEB ANDA YANG SUDAH DI-DEPLOY ULANG
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbw5nmCIAbbgz8XeMBc63VT-8PsnmpkZrJuFHREZsNfMAl1nah8gLrM0-AnnrSDMmFIUjA/exec";
    
    // Variabel untuk menyimpan data dari spreadsheet
    let classData = {};

    const kelasSelect = document.getElementById('kelas');
    const muridSelect = document.getElementById('nama_murid');

    // 1. Saat halaman dimuat, ambil semua data
    document.addEventListener('DOMContentLoaded', () => {
        fetch(SCRIPT_URL)
            .then(response => response.json())
            .then(data => {
                classData = data.classData;
                const kelasOptions = Object.keys(classData).sort(); // Ambil nama kelas dan urutkan
                
                // Isi dropdown kelas
                kelasSelect.innerHTML = '<option value="">Pilih Kelas...</option>';
                kelasOptions.forEach(kelas => {
                    const option = document.createElement('option');
                    option.value = kelas;
                    option.textContent = kelas;
                    kelasSelect.appendChild(option);
                });
            })
            .catch(error => {
                console.error('Error fetching data:', error);
                kelasSelect.innerHTML = '<option value="">Gagal memuat data</option>';
            });
    });

    // 2. Tambahkan event listener saat dropdown kelas berubah
    kelasSelect.addEventListener('change', function() {
        const selectedClass = this.value;
        muridSelect.innerHTML = ''; // Kosongkan pilihan murid

        if (selectedClass) {
            muridSelect.disabled = false;
            muridSelect.innerHTML = '<option value="">Pilih Nama Murid...</option>';
            
            const students = classData[selectedClass] || [];
            students.forEach(student => {
                const option = document.createElement('option');
                option.value = student;
                option.textContent = student;
                muridSelect.appendChild(option);
            });
        } else {
            muridSelect.disabled = true;
            muridSelect.innerHTML = '<option value="">Pilih kelas terlebih dahulu</option>';
        }
    });

    // 3. Fungsi untuk mengirim data (tidak ada perubahan signifikan)
    document.getElementById('penilaianForm').addEventListener('submit', function(e) {
      e.preventDefault();
      // ... (Kode submit form sama persis seperti jawaban sebelumnya)
    });
  </script>
</body>
</html>
